<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "üçÖ tomatech" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.svg" type="image/svg+xml" sizes="any">
    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>


    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.tailwindcss.com/3.4.1?plugins=typography"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script>
      // Initialize theme early and avoid ReferenceError before Alpine boots
      window.__theme = localStorage.getItem('theme') || 'light';
      if (window.__theme === 'dark') {
        document.documentElement.classList.add('dark');
      }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">



    <style>
        body { font-family: 'Inter', sans-serif; }
        body, header, main, footer { transition: background-color 0.3s ease, color 0.3s ease; }
        [x-cloak] { display: none !important; }
    </style>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'off-white': '#f8f7f2', 'brand-dark': '#2d3748', 'brand-accent': '#3b82f6',
                        'dark-bg': '#1a202c', 'dark-text': '#cbd5e0',
                    }
                }
            }
        }
    </script>
  </head>

  <body class="bg-off-white text-brand-dark dark:bg-dark-bg dark:text-dark-text antialiased" x-data="{ theme: window.__theme }" x-effect="localStorage.setItem('theme', theme)">
    <div class="max-w-3xl mx-auto px-6 py-8 md:py-12">

      <!-- HEADER -->
      <header class="flex justify-between items-center mb-12">
          <a href="/" class="text-xl md:text-2xl font-bold text-brand-dark dark:text-white hover:text-brand-accent dark:hover:text-brand-accent transition-colors">
              üçÖ tomatech
          </a>
          <div class="flex items-center space-x-4">
              <button @click="theme = (theme === 'light' ? 'dark' : 'light'); window.__theme = theme; document.documentElement.classList.toggle('dark')"
                      class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"
                      aria-label="Toggle Dark Mode">
                  <svg x-show="theme === 'light'" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                  <svg x-show="theme === 'dark'" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
              </button>
          </div>
      </header>
      <%= yield %>

       <!-- FOOTER (simple) -->
        <footer class="mt-20 pt-8 border-t border-gray-200 dark:border-gray-700">
          <div class="text-center">
          <%#
            <h3 class="text-base font-semibold text-gray-800 dark:text-gray-100">Subscribe to get future posts via email</h3>
            <form action="#" method="post" class="mt-4 flex flex-col sm:flex-row items-center justify-center gap-3">
              <input type="email" name="email" placeholder="Type your email‚Ä¶" class="w-full sm:w-80 px-4 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-brand-accent dark:bg-dark-bg dark:border-gray-700" required>
              <button type="submit" class="px-4 py-2 bg-brand-accent text-white rounded-md hover:bg-blue-600">Subscribe</button>
            </form>
            <p class="mt-4 text-sm text-gray-600 dark:text-gray-400">
              or grab the <a href="#" class="underline hover:text-brand-accent">RSS feed</a>
            </p> %>
            <p class="mt-6 text-xs text-gray-500 dark:text-gray-500">&copy; <%= Time.current.year %> tomatech üçÖ </p>
          </div>
        </footer>

    </div>
  </body>
</html>
